webpackJsonp([1],{NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("7+uW"),n={name:"Header",data:function(){return{localStorage:localStorage.signedIn}},computed:{sigendIn:function(){return this.$store.state.localStorage}},created:function(){},methods:{setError:function(e,t){this.error=e.response&&e.response.data&&e.response.data.error||t},signedIn:function(){return localStorage.signedIn},signOut:function(){var e=this;this.$http.secured.delete("/signin").then(function(t){delete localStorage.csrf,delete localStorage.signedIn,e.localStorage="",e.$store.dispatch("switchLogin"),e.$router.replace("/")}).catch(function(t){return e.setError(t,"Cannot sign out")})}}},a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("header",{staticClass:"bg-grey-lighter py-4"},[s("div",{staticClass:"container m-auto flex flex-wrap items-center justify-end"},[s("div",{staticClass:"flex-1 flex items-center"},[s("svg",{staticClass:"fill-current text-indigo",attrs:{viewBox:"0 0 24 24",width:"24",height:"24"}},[s("title",[e._v("record vinyl")]),s("path",{attrs:{d:"M23.938 10.773a11.915 11.915 0 0 0-2.333-5.944 12.118 12.118 0 0 0-1.12-1.314A11.962 11.962 0 0 0 12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12c0-.414-.021-.823-.062-1.227zM12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-5a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"}})]),e._v(" "),s("a",{staticClass:"uppercase text-sm font-mono pl-4 font-semibold no-underline text-indigo-dark hover:text-indigo-darker",attrs:{href:"/"}},[e._v("Record Store")])]),e._v(" "),s("div",[s("div",[e._v(e._s(e.$data))]),e._v(" "),s("div",[e._v("store.local: "+e._s(e.sigendIn))]),e._v(" "),e.sigendIn?e._e():s("router-link",{staticClass:"link-grey px-2 no-underline",attrs:{to:"/"}},[e._v("Sign in")]),e._v(" "),e.sigendIn?e._e():s("router-link",{staticClass:"link-grey px-2 no-underline",attrs:{to:"/signup"}},[e._v("Sign Up")]),e._v(" "),e.sigendIn?e._e():s("router-link",{staticClass:"link-grey px-2 no-underline",attrs:{to:"/records"}},[e._v("Records")]),e._v(" "),e.sigendIn?s("router-link",{staticClass:"link-grey px-2 no-underline",attrs:{to:"/artists"}},[e._v("Artists")]):e._e(),e._v(" "),e.sigendIn?s("a",{staticClass:"link-grey px-2 no-underline",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.signOut(t)}}},[e._v("Sign out")]):e._e()],1)])])},staticRenderFns:[]},i={name:"App",components:{Header:s("VU/8")(n,a,!1,null,null,null).exports}},o={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("Header"),this._v(" "),t("router-view")],1)},staticRenderFns:[]},l=s("VU/8")(i,o,!1,null,null,null).exports,c=s("NYxO");r.a.use(c.a);var d=new c.a.Store({state:{count:0,localStorage:localStorage.signedIn},getters:{localStorage:function(e){return e.localStorage}},mutations:{localStorageSignedSwitch:function(e,t){e.localStorage?e.localStorage=!1:e.localStorage=!0}},actions:{switchLogin:function(e,t){(0,e.commit)("localStorageSignedSwitch",t)}}}),u=s("/ocq"),p={name:"Signin",data:function(){return{email:"",password:"",error:""}},created:function(){this.checkSignedIn()},updated:function(){this.checkSignedIn()},methods:{signin:function(){var e=this;this.$http.plain.post("/signin",{email:this.email,password:this.password}).then(function(t){return e.signinSuccesful(t)}).catch(function(t){return e.signinFailed(t)})},signinSuccesful:function(e){e.data.csrf?(localStorage.csrf=e.data.csrf,localStorage.signedIn=!0,this.error="",this.$store.dispatch("switchLogin"),this.$router.replace("/records")):this.signinFailed(e)},signinFailed:function(e){this.error=e.response&&e.response.data&&e.response.data.error||"",delete localStorage.csrf,delete localStorage.signedIn},checkSignedIn:function(){localStorage.signedIn&&this.$router.replace("/records")}}},m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"max-w-sm m-auto my-8"},[s("div",{staticClass:"border p-10 border-grey-light shadow rounded"},[s("h3",{staticClass:"text-2xl mb-6 text-grey-darkest"},[e._v("Sign in")]),e._v(" "),s("form",{on:{submit:function(t){return t.preventDefault(),e.signin(t)}}},[e.error?s("div",{staticClass:"text-red"},[e._v(e._s(e.error))]):e._e(),e._v(" "),s("div",{staticClass:"mb-6"},[s("label",{staticClass:"label",attrs:{for:"email"}},[e._v("E-mail Address")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"input",attrs:{type:"email",id:"email",placeholder:"andy@web-crunch.com"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})]),e._v(" "),s("div",{staticClass:"mb-6"},[s("label",{staticClass:"label",attrs:{for:"password"}},[e._v("Password")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"input",attrs:{type:"password",id:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),e._v(" "),s("button",{staticClass:"font-sans font-bold px-4 rounded cursor-pointer\n      no-underline bg-green hover:bg-green-dark block w-full py-4 text-white items-center justify-center",attrs:{type:"submit"}},[e._v("Sign In")]),e._v(" "),s("div",{staticClass:"my-4"},[s("router-link",{staticClass:"link",attrs:{to:"/signup"}},[e._v("Sign Up")])],1)])])])},staticRenderFns:[]},g=s("VU/8")(p,m,!1,null,null,null).exports,f={name:"Signup",data:function(){return{email:"",name:"",password:"",password_confirmation:"",error:""}},created:function(){this.checkSignedIn()},updated:function(){this.checkSignedIn()},methods:{signup:function(){var e=this;this.$http.plain.post("/signup",{email:this.email,name:this.name,password:this.password,password_confirmation:this.password_confirmation}).then(function(t){return e.signupSuccesful(t)}).catch(function(t){return e.signupFailed(t)})},signupSuccesful:function(e){e.data.csrf?(localStorage.csrf=e.data.csrf,localStorage.signedIn=!0,console.log(localStorage.csrf),this.error="",this.$router.replace("/records")):this.signinFailed(e)},signupFailed:function(e){this.error=e.response&&e.response.data&&e.response.data.error||"Something went wrong",delete localStorage.csrf,delete localStorage.signedIn},checkSignedIn:function(){localStorage.signedIn&&this.$router.replace("/records")}}},v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"max-w-sm m-auto my-8"},[s("div",{staticClass:"border p-10 border-grey-light shadow rounded"},[s("h3",{staticClass:"text-2xl mb-6 text-grey-darkest"},[e._v("Sign Up")]),e._v(" "),s("form",{on:{submit:function(t){return t.preventDefault(),e.signup(t)}}},[e.error?s("div",{staticClass:"text-red"},[e._v(e._s(e.error))]):e._e(),e._v(" "),s("div",{staticClass:"mb-6"},[s("label",{staticClass:"label",attrs:{for:"email"}},[e._v("E-mail Address")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"input",attrs:{type:"email",id:"email",placeholder:"seasolver@example.com"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})]),e._v(" "),s("div",{staticClass:"mb-6"},[s("label",{staticClass:"label",attrs:{for:"name"}},[e._v("ニックネーム")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"input",attrs:{type:"text",id:"name",placeholder:"ウミガメさん"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}})]),e._v(" "),s("div",{staticClass:"mb-6"},[s("label",{staticClass:"label",attrs:{for:"password"}},[e._v("Password")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"input",attrs:{type:"password",id:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),e._v(" "),s("div",{staticClass:"mb-6"},[s("label",{staticClass:"label",attrs:{for:"password"}},[e._v("Password_confirmation")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.password_confirmation,expression:"password_confirmation"}],staticClass:"input",attrs:{type:"password",id:"password_confirmation"},domProps:{value:e.password_confirmation},on:{input:function(t){t.target.composing||(e.password_confirmation=t.target.value)}}})]),e._v(" "),s("button",{staticClass:"font-sans font-bold px-4 rounded cursor-pointer\n      no-underline bg-green hover:bg-green-dark block w-full py-4 text-white items-center justify-center",attrs:{type:"submit"}},[e._v("Sign Up")]),e._v(" "),s("div",{staticClass:"my-4"},[s("router-link",{staticClass:"link-grey",attrs:{to:"/"}},[e._v("Sign In")])],1),e._v(" "),s("div",{staticClass:"my-4"},[s("router-link",{staticClass:"link-grey",attrs:{to:"/users"}},[e._v("Check users")])],1)])])])},staticRenderFns:[]},h=s("VU/8")(f,v,!1,null,null,null).exports,_={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"max-w-md m-auto py-10"},[e.error?s("div",{staticClass:"text-red"},[e._v(e._s(e.error))]):e._e(),e._v(" "),s("h3",{staticClass:"font-mono font-regular text-3xl mb-4"},[e._v("All Users")]),e._v(" "),s("ul",{staticClass:"list-reset mt-4"},e._l(e.users,function(t){return s("li",{key:t.id,staticClass:"py-4"},[s("div",{staticClass:"flex items-center justify-between flex-wrap"},[s("div",{staticClass:"flex-1 flex justify-between flex-wrap pr-4"},[s("p",{staticClass:"block font-mono font-semibold flex items-center"},[s("svg",{staticClass:"fill-current text-indigo w-6 h-6 mr-2",attrs:{viewBox:"0 0 24 24",width:"24",height:"24"}},[s("title",[e._v("user vinyl")]),s("path",{attrs:{d:"M23.938 10.773a11.915 11.915 0 0 0-2.333-5.944 12.118 12.118 0 0 0-1.12-1.314A11.962 11.962 0 0 0 12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12c0-.414-.021-.823-.062-1.227zM12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-5a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"}})]),e._v("\n            "+e._s(t.id)+" — "+e._s(t.name)+"\n            "+e._s(t.email)+"\n          ")])])])])}),0)])},staticRenderFns:[]},w=s("VU/8")({name:"User",data:function(){return{users:[],error:""}},created:function(){var e=this;this.$http.secured.get("/").then(function(t){e.users=t.data}).catch(function(t){return e.setError(t,"Something went wrong")})},methods:{setError:function(e,t){this.error=e.response&&e.response.data&&e.response.data.error||t},getArtist:function(e){var t=this.artists.filter(function(t){return t.id===e.artist_id}),s=void 0;return t.forEach(function(e){s=e.name}),s},addRecord:function(){var e=this;this.newRecord&&this.$http.secured.post("/api/v1/records/",{record:{title:this.newRecord.title,year:this.newRecord.year,artist_id:this.newRecord.artist}}).then(function(t){e.records.push(t.data),e.newRecord=""}).catch(function(t){return e.setError(t,"Cannot create record")})},removeRecord:function(e){var t=this;this.$http.secured.delete("/api/v1/records/"+e.id).then(function(s){t.records.splice(t.records.indexOf(e),1)}).catch(function(e){return t.setError(e,"Cannot delete record")})},editRecord:function(e){this.editedRecord=e},updateRecord:function(e){var t=this;this.editedRecord="",this.$http.secured.patch("/api/v1/records/"+e.id,{record:{title:e.title,year:e.year,artist_id:e.artist}}).catch(function(e){return t.setError(e,"Cannot update record")})}}},_,!1,null,null,null).exports,S={name:"NotFound",data:function(){return{text:"This page is not found!",localStorage:localStorage.signedIn}}},C={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"ml-20 mt-10 text-grey-darkest"},[this._v("\n  "+this._s(this.$data)+"\n")])},staticRenderFns:[]},x=s("VU/8")(S,C,!1,null,null,null).exports;r.a.use(u.a);var b=new u.a({mode:"history",routes:[{path:"/",name:"Signin",component:g},{path:"/signup",name:"Signup",component:h},{path:"/users",name:"User",component:w},{path:"*",name:"NotFound",component:x}]}),y=s("Rf8U"),k=s.n(y),I=s("//Fk"),R=s.n(I),$=s("Dd8w"),E=s.n($),F=s("mtWM"),U=s.n(F),N=U.a.create({baseURL:"https://seasolver.herokuapp.com/",withCredentials:!0,headers:{"Content-Type":"application/json"}}),A=U.a.create({baseURL:"https://seasolver.herokuapp.com/",withCredentials:!0,headers:{"Content-Type":"application/json"}});N.interceptors.request.use(function(e){var t=e.method.toUpperCase();return"OPTIONS"!==t&&"GET"!==t&&(e.headers=E()({},e.headers,{"X-CSRF-TOKEN":localStorage.csrf})),e}),N.interceptors.request.use(null,function(e){return e.response&&e.response.config&&401===e.reponse.status?A.post("/refresh",{},{headers:{"X-CSRF-TOKEN":localStorage.csrf}}).then(function(t){localStorage.csrf=t.data.csrf,localStorage.signedIn=!0;var s=e.response.config;return s.headers["X-CSRF-TOKEN"]=localStorage.csrf,A.request(s)}).catch(function(e){return delete localStorage.csrf,delete localStorage.signedIn,location.replace("/"),R.a.reject(e)}):R.a.reject(e)});s("Q00M");r.a.config.productionTip=!1,r.a.use(c.a),r.a.use(k.a,{secured:N,plain:A}),new r.a({el:"#app",store:d,router:b,securedAxiosInstance:N,plainAxiosInstance:A,components:{App:l},template:"<App/>"})},Q00M:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.fb457cad08c82a054c78.js.map